image:
  file: .gitpod.dockerfile

tasks:
  - before: |
      export PATH=/usr/lib/dart/bin:$FLUTTER_HOME/bin:$ANDROID_HOME/bin:$ANDROID_HOME/platform-tools:$PATH
      mkdir -p /home/gitpod/.android
      touch /home/gitpod/.android/repositories.cfg
    init: |
      echo "Installing Flutter SDK..."
      /home/gitpod/android-sdk/tools/bin/sdkmanager 'platform-tools' 'platforms;android-30' 'build-tools;30.0.3'
      /workspace/android-sdk/tools/bin/sdkmanager 'platform-tools' 'platforms;android-30' 'build-tools;30.0.3'
      echo "Init Flutter..."
      cd /workspace/ha_client
      'yes | flutter upgrade'
      flutter update-packages --force-upgrade &&
      flutter config --enable-web
      flutter doctor --android-licenses
      flutter pub get
      flutter run -d web-server --no-resident
    command: |
      flutter doctor
      echo "Ready to go!"
      flutter run -d web-server --web-port=8080 --web-hostname=0.0.0.0
ports:
  - port: 9100
    onOpen: ignore
  - port: 5037
    onOpen: ignore
  - port: 5900
    onOpen: ignore
  - port: 6080
    onOpen: ignore
  - port: 8080
    onOpen: open-preview
vscode:
  extensions:
    - Dart-Code.dart-code@3.5.1:W6zqgIED1gxtkBH/pbfGXA==
    - Dart-Code.flutter@3.5.1:0FyuzXye7dV19PNst3+Llg==
